<!DOCTYPE html>
<html>
<head>
  <title>Data Detector</title>
</head>
<body>
  <h1>Data Detector</h1>

  <h2>URL Parameters:</h2>
  <pre id="urlParams"></pre>

  <h2>Referrer:</h2>
  <p id="referrer"></p>

  <h2>Last Clicked Element Info:</h2>
  <pre id="clickInfo"></pre>

  <h2>Messages Received (via postMessage):</h2>
  <pre id="messages"></pre>

<script>
  // Show all URL parameters
  const urlParams = new URLSearchParams(window.location.search);
  const paramsObj = {};
  urlParams.forEach((value, key) => {
    paramsObj[key] = value;
  });
  document.getElementById('urlParams').textContent = JSON.stringify(paramsObj, null, 2);

  // Show referrer
  document.getElementById('referrer').textContent = document.referrer || 'No referrer';

  // Show info on last clicked element
  document.addEventListener('click', e => {
    const el = e.target;
    let info = {
      tagName: el.tagName,
      id: el.id,
      classes: el.className,
      text: el.innerText ? el.innerText.trim().slice(0, 100) : '',
      href: el.href || null,
      src: el.src || null,
    };
    document.getElementById('clickInfo').textContent = JSON.stringify(info, null, 2);
  });

  // Listen for postMessage events
  window.addEventListener('message', event => {
    // For security, you might want to check event.origin here
    const msgElem = document.getElementById('messages');
    let current = msgElem.textContent;
    current += '\n' + JSON.stringify(event.data);
    msgElem.textContent = current;
  });
</script>
</body>
</html>
